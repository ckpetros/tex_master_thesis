% !TEX root = Master.tex

A $d$-dimensional function $C: [0,1]^d \rightarrow [0,1]$ is called a \textit{copula}, if it is a \ac{CDF} with uniform margins, i.e.
\begin{equation}
P\left(U_{1} \leq u_{1}, \ldots, U_{d} \leq u_{d}\right)=C\left(u_{1}, \ldots, u_{d}\right)
\end{equation}
where 
$ U_{i}, \hspace{0.25em} i = 1, \ldots, d $ 
are uniformly distributed \acp{RV} in $[0,1]$.\\
Since $C$ is a \ac{CDF}, following properties emerge:
\begin{itemize}
\item $C(\mathbf{u})=C\left(u_{1}, \ldots, u_{d}\right)$ is increasing in each component $u_i, i = 1, \ldots, d$.
\item The $i^{th}$ marginal distribution is obtained by setting $u_j = 1$ for $j \neq i$ and it has to be uniformly distributed 
\begin{equation}
C\left(1, \ldots, 1, u_{i}, 1, \ldots, 1\right)=u_{i}
\end{equation}
\item For $a_i \leq b_i$, the probability $P\left(U_{1} \in\left[a_{1}, b_{1}\right], \ldots, U_{d} \in\left[a_{d}, b_{d}\right]\right)$ mus be non-negative, so we obtain the \textit{rectangle inequality} 
\begin{equation}
\sum_{i_{1}=1}^{2} \cdots \sum_{i_{d}=1}^{2}(-1)^{i_{1}+\cdots+i_{d}} C\left(u_{1, i_{1}}, \ldots, u_{d, i_{d}}\right) \geq 0,
\end{equation}
where $u_{j,1} = a_j$ and $u_{j,2} = b_j$.
\label{eq:rectangle_inequality}
\end{itemize}
The reverse is also true, i.e. any function $C$ that satisfies the above properties is a copula. Furthermore, $C\left(1, u_{1}, \ldots, u_{d-1}\right)$ is also a $(d-1)$-dimensional copula and thus all $k$-dimensional margins with $2<k<d$ are copulas.\\ 

\textbf{Generalized Inverse}\\
For a \ac{CDF}, the \textit{generalized inverse} is defined by
\begin{equation}
F^{\leftarrow}(y):=\inf \{x: F(x) \geq y\}.
\label{eq:generalized_inverse}
\end{equation}


\textbf{Probability Transformation}\\
If a \ac{RV} $Y$ has a continuous \ac{CDF} $F$, then
\begin{equation}
F(Y) \sim U[0,1].
\label{eq:probability_transformation}
\end{equation}



\textbf{Quantile Transformation}\\
If $U \sim U[0,1]$ and $F$ be a \ac{CDF}, then
\begin{equation}
P\left(F^{\leftarrow}(U) \leq x\right)=F(x)
\label{eq:quantile_transformation}
\end{equation}

The \textit{probability transformation} is the reverse of the \textit{quantile transformation}. These two transformations allow us to move back and forth between $\mathbb{R}^d$ and $[0,1]^d$ and are the primary building blocks when it comes to copulas. Against this backdrop, \textit{Sklar's theorem} is introduced, which is considered the foundation of all copula related applications.\\




\textbf{Sklar's Theorem} \citep{sklar1959fonctions} \\
Let $F$ be a $d$-dimensional \ac{CDF} with marginal distributions $F_{i}, \hspace{0.25em} i = 1, \ldots, d$.
Then there exists a copula $C$ such that
\begin{equation}
F(x_1, \ldots, x_d) = C (F_1(x_1), \ldots, F_d(x_d))
\label{eq:sklar}
\end{equation}
for all $x_i \in \mathbb{R}, \hspace{0.25em} i = 1, \ldots, d $.\\
The copula $C$ is unique, if $ \hspace{0.25em} \forall i = 1, \ldots, d \hspace{0.25em}$,  $F_i \hspace{0.25em}$  is continuous. Otherwise $C$ is uniquely determined only on
$Ran(F_1) \times \ldots \times Ran(F_d)$, where $Ran(F_{i})$ is the range of $F_i$.\\
Conversely, if $C$ is a $d$-dimensional copula and $F_1, \ldots, F_d$ are univariate \ac{CDF}'s, then $F$ as defined in \autoref{eq:sklar} is a 
$d$-dimensional \ac{CDF}.
\\

If the copula has a \ac{PDF}, then the \textit{copula density} is defined as
\begin{equation}
c(\mathbf{u})=\frac{\partial^{d} C\left(u_{1}, \ldots, u_{d}\right)}{\partial u_{1} \cdots \partial u_{d}} 
\label{eq:copula_density_1}
\end{equation}
for a differentiable copula function $C$ and the realization of a random vector $ \bm{u} = (u_1, \ldots, u_d)$.\\
By virtue of \autoref{eq:sklar} in Sklar's theorem and given that
\begin{equation} 
C(\mathbf{u})=F\left(F_{1}^{\leftarrow}\left(u_{1}\right), \ldots, F_{d}^{\leftarrow}\left(u_{d}\right)\right) ,
\label{eq:sklar_2}
\end{equation}
i.e. inversible \ac{CDF}s $ F_i, \hspace{0.25em} i = 1, \ldots, d, \hspace{0.25em}$ we can rewrite the copula density to
\begin{equation}
c\left(u_{1}, \ldots, u_{d}\right)=\frac{f\left(F_{1}^{\leftarrow}\left(u_{1}\right), \ldots, F_{d}^{\leftarrow}\left(u_{d}\right)\right)}{\prod \limits _{i=1}^{d} f_{i}\left(F_{i}^{\leftarrow}\left(u_{i}\right)\right)}
\label{eq:copula_density_2}
\end{equation}
for densities $f$ of $F$ and $f_1, \ldots, f_d$ of the corresponding margins.\\



Often times, a transformation is applied to the data, such as a log- or square root transformation. However, due to the \textit{invariance principle}, this does not affect the copula.\\

\textbf{Invariance Principal}\\
Suppose the \ac{RV}s $ X_1, \ldots, X_d $  have continuous margins and copula $C$. For strictly increasing functions $T_i : \mathbb{R} \rightarrow \mathbb{R}, i = 1, \ldots, d$, the \ac{RV}s $T_1(X_1), \ldots, T_d(X_d)$ also have copula $C$.
%\\
%
%\textbf{Fr\'echet-Hoeffding Bounds}\\
%Let $C(\bm{u}) = C(u_1, \ldots, u_d)$ be any $d$-dimensional copula.\\
%Then, for
%\begin{equation}
%W(\boldsymbol{u})=\max \left\{\sum\limits_{i=1}^{d} u_{i}-d+1, \hspace{0.25em} 0\right\}
%\label{eq:frechet_hoeffding_lower}
%\end{equation}
%as well as
%\begin{equation}
%M(\boldsymbol{u})=\min \limits _{1 \leq i \leq d}\left\{u_{i}\right\},
%\label{eq:frechet_hoeffding_upper}
%\end{equation}
%it holds that
%\begin{equation}
%W(\bm{u}) \leq C(\bm{u}) \leq M(\bm{u}), \quad \bm{u} \in[0,1]^{d}.
%\label{eq:frechet_hoeffding}
%\end{equation}\\
%$W$ is called the \textit{lower Fr\'echet-Hoeffding bound} and $M$ the \textit{upper Fr\'echet-Hoeffding bound}.\\
%Note that $W$ is a copula if and only if $d=2$, whereas $M$ is a copula for all $d \geq 2$ (more on this later in Section \ref{sssec:fundamental_copulas}).




