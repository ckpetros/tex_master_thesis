% !TEX root = Master.tex

Modelling of the marginal response distributions along with their dependence structure has been studied so far in a strictly parametric context, not considering any potentially available covariate information. In this section, the copula framework will be broadened by adding conditions given possible covariates for all model parameters, i.e. both for the parameters of the margins as well as the copula parameter. All involved model parameters will receive \textit{structured additive predictors} (see Section \ref{ssec:gam}) to account for possible non-linear or random effects. We will summarily explore \textit{Structured Additive Conditional Copulas}\footnote{In \cite{klein2016simultaneous} they are referred to as "structured additive conditional copula regression models".} and for extensive literature, good references to view are \cite{klein2016simultaneous} \& \cite{marra1605bivariate}.
% and \cite{vatter2019gamcopula}. 
Note that notations (such as symbols or letters) may differ from some of the reference literatures in order to align them with this paper. \\

To get started, we define $(Y_1, Y_2)'$ to be independent bivariate responses and $\bm{\nu}$ being the information contained in covariates. Ergo, \autoref{eq:sklar} of Sklar's theorem can be extended to the conditional case
\begin{equation}
F_{1,2}\left(Y_{1}, Y_{2} | \bm{\nu} \right)=C\left(F_{1}\left(Y_{1} | \bm{\nu} \right), F_{2}\left(Y_{2} | \bm{\nu} \right) | \bm{\nu} \right)
\label{eq:sklar_conditional}
\end{equation}
in conjunction with all facets of Section \ref{ssec:intro_to_copulas} \citep{patton2006modelling}.\\
The marginal \acp{CDF} $F_{d}\left(y_{i d} | \bm{\nu}_i\right)$ for observations $i = 1,\ldots, n$ can also be stated as
\begin{equation}
F_{d}\left(y_{i d} | \vartheta_{i 1}^{(d)}, \ldots, \vartheta_{i K_{d}}^{(d)}\right), \quad d = 1, 2,
\end{equation}
i.e. the distribution $F_d$ has a total of $K_d$ parameters, denoted as $\vartheta_{i 1}^{(d)}, \ldots, \vartheta_{i K_{d}}^{(d)}$.
To relate all parameters of the margins to structured additive predictors $\eta_i^{\vartheta_k^{(d)}},  k = 1,\ldots, K_d$ consisting of the covariates $\bm{\nu}_i$ (see Section \ref{ssec:gam}), we employ strictly increasing response mappings $h_k^{(d)}$ to ensure proper domain allocation, i.e.
\begin{equation}
\vartheta_{i k}^{(d)}=h_{k}^{(d)}(\eta_{i}^{\vartheta_{k}^{(d)}}).
\label{eq:parameter_mapping}
\end{equation}
\\

Assuming that the parameters of the copula can also depend on covariates $\bm{\nu}_i$ while Sklar's theorem applies as usual, the left-hand side of \autoref{eq:sklar_conditional} can equivalently be stated as  
$$
F_{1,2}(y_{i 1}, y_{i 2} | v_{i})= F_{1,2}(y_{i 1}, y_{i 2} | \vartheta_{i 1}^{(1)}, \ldots, \vartheta_{i K_{1}}^{(1)}, \vartheta_{i 1}^{(2)}, \ldots,
\vartheta_{i K_{2}}^{(2)}, \vartheta_{i 1}^{(c)}, \ldots, \vartheta_{i K_{c}}^{(c)}),
$$
where the last share of parameters $\vartheta_{i 1}^{(c)}, \ldots, \vartheta_{i K_{c}}^{(c)}$ belong to the copula. Similar to \autoref{eq:parameter_mapping}, the copula parameters are modelled as $\vartheta_{i k}^{(c)}=h_{k}^{(c)}(\eta_{i}^{\vartheta_{k}^{(c)}})$ with $K_c$ being the number of parameters.













